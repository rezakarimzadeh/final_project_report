
\فصل{مرور ادبیات}

\قسمت{مقدمه}
در این فصل سوابق و مطالعات انجام شده برای قطعه‌بندی تصاویر پزشکی بررسی خواهند شد. در ابتدا مفاهیم مقدماتی و تعاریف مرتبط با این حوزه معرفی می‌شوند و سپس روش‌های پیشنهاد شده، برای قطعه‌بندی تصاویر پزشکی مورد مطالعه قرار خواهند گرفت. در نهایت رویکردهای قطعه‌بندی تومور و ساختارهای در ریسک با استفاده از روش‌‌های یادگیری عمیق معرفی و بررسی می‌شوند.

\قسمت{تعاریف و مفاهیم اولیه}
در این قسمت تعاریف و مفاهیم اولیه‌ی مرتبط با قطعه‌بندی ارایه می‌گردد. در ابتدا مفهوم قطعه‌بندی معرفی می‌شود و سپس اهداف و چالش‌های قطعه‌بندی بررسی می‌شود، سپس انواع دسته‌بندی روش‌های قطعه‌بندی معرفی می‌گردد و در نهایت معیارهای ارزیابی قطعه‌بندی مطالعه خواهد شد.

\زیرقسمت{تعریف قطعه‌بندی}
همانطور که در فصل دوم اشاره گردید، یک تصویر پزشکی می‌تواند دوبعدی (تصاویر رادیوگرافی) یا سه‌بعدی (تصاویر ام‌آرآی و سی‌تی اسکن) که به عناصر سازنده‌ی این تصاویر بر اساس این ابعاد، پیکسل و یا واکسل گفته می‌شود. برای قطعه‌بندی تصاویر تعاریف متنوعی ارایه شده‌است که در زیر به بررسی هر یک پرداخته می‌شود.

\شروع{فقرات}
\فقره به جزء‌بندی یک تصویر به مناطق غیر هم‌پوشان همگن که یک ویژگی یا یک معیار مشترک مانند شدت نوری\LTRfootnote{َIntensity}، شکل\LTRfootnote{Shape} و یا بافت\LTRfootnote{َTexture} همسان دارند قطعه‌بندی گفته می‌شود.

\فقره به روند نسبت دادن یک برچسب با مفهوم بیولوژیکی خاص به پیکسل‌ها و یا واکسل‌ها که این پیکسل‌ها و واکسل‌ها یک ویژگی خاص مشترک دارند و یا متعلق به یک آناتومی مشترک هستند. 

\فقره جداسازی ساختارهای مد نظر از یکدیگر و از پس‌زمینه را قطعه‌بندی می‌گویند \مرجع{Fatemizadeh}.
\پایان{فقرات}
با توجه به تعاریف انجام شده، می‌توان یک تعریف ریاضی برای این عملیات ارایه داد. اگر تصویر را $I$ بنامیم، آنگاه قطعه‌بندی یعنی مشخص کردن مجموعه‌هایی ($S_{k}$) در تصویر که $S_{k} \subset I$ و اجتماع این مجموعه‌ها کل تصویر را بازسازی کند و این مجموعه‌ها هیچ اشتراکی نداشته باشند:
\begin{alignat}{5}
	 &\cup_{k=1}^{K} S_{k} = I     \label{seg_def} && \\
	 &\text{\lr{where}} \quad S_{k} \cap S_{j} = \varnothing \quad for \quad k \neq j && \notag
\end{alignat}

به صورت ایده‌آل قطعه‌بندی به صورتی انجام می‌شود که هر یک از $S_{k}$ها یک ساختار و آناتومی خاص را نشان می‌دهد. شرط دیگر در این فرمول‌بندی متصل بودن هریک از این $S_{k}$هاست که برای ساختارهای آناتومیکی یکپارچه این شرط باید برقرار شود. اگر از این شرط چشم‌پوشی کنیم قطعه‌بندی در سطح پیکسل (واکسل) صورت می‌گیرد و در مواردی استفاده می‌شود که ساختارهای مورد نظر از یکدیگر گسسته هستند اما خواص مشابه دیگری دارند \مرجع{pham2000current}. 

\زیرقسمت{اهداف قطعه‌بندی تصاویر پزشکی}
در روند قطعه‌بندی تصاویر پزشکی، جزییات مورد نظر در استخراج قطعه‌ها، بسیار به کاربرد کیلینیکی بستگی دارد. هدف قطعه‌بندی بهبود نمایش تصاویر و اجزای مختلف آن برای تشخیص و درمان کارآمدتر است. به طور کلی از مهم‌ترین اهداف قطعه‌بندی می‌توان به موارد زیر اشاره کرد:
\begin{multicols}{2}
	\شروع{فقرات}
	\فقره تشخیص بیماری
	\فقره مطالعه‌ی پیشرفت بیماری
    \فقره تهیه‌ی نقشه‌ی درمان
    \فقره تخمین حجم تومور
	\پایان{فقرات}
	
	\شروع{فقرات}
	\فقره کمی‌سازی پیشرفت بیماری
	\فقره استخراج ویژگی
	\فقره موقعیت یابی تومور
	\فقره تطبیق تصاویر
	\پایان{فقرات}
	
\end{multicols}

به‌طور کلی قطعه‌بندی تصاویر پزشکی سهم عمده‌ای در تحلیل و پردازش تصاویر پزشکی دارد که امکان بررسی مشکلات عملکردی ساختارهای آناتومیکی مختلف را فراهم می‌سازد و تمام فاکتورهای لازم برای تشخیص، کمی‌سازی و مطالعه‌ی پیشرفت بیماری را میسر می‌سازد \مرجع{zuva2011image, sharma2010automated}.

\زیرقسمت{چالش‌های قطعه‌بندی تصاویر پزشکی}
قطعه‌بندی تصاویر پزشکی، با مشکلات زیادی مواجه است که کیفیت قطعه‌بندی نهایی به دلیل وجود برخی اشکالات در تصویر اصلی پدید می‌آید. از جمله‌ی این اشکالات می توان به موارد زیر اشاره نمود \مرجع{shrimali2009current}.

\زیرزیرقسمت{نویز}
با حضور نویز در تصویر عدم قطعیت بالا می‌رود و مقدار شدت پیکسل‌ها در تصویر تغییر می‌کند که این تغییر باعث دگرگونی ساختار همگن بافت‌ها می‌شود و در نتیجه قطعه‌بندی دشوار می‌گردد  
\مرجع{al2010comparative}.

\زیرزیرقسمت{ناهمگنی شدت}
ناهمگنی شدت\LTRfootnote{َIntensity In-homogeneity} به تغییرات جعلی و هموار در شدت‌های داخل تصویر گفته می‌شود که نمایانگر یک بافت با یک ویژگی مشترک هستند اما به دلیل تغییرات در میدان دستگاه تصویرگر، پدید می‌آیند. این مشکل اغلب در تصاویر ام‌آرای به دلیل تغییر میدان مغناطیسی آن بوجود می‌آیند. شکل ~\رجوع{شکل:اینهمو} در سمت چپ یک تصویر مغزی دچار این مشکل نشان داده شده است و در شکل وسط، ناهمگونی میدان دستگاه تصویربرداری استخراج شده و در نهایت در شکل راست با تقسیم تصویر مشکل‌دار بر ناهمگنی میدان، تصویر ترمیم شده بدست آمده است \مرجع{vovk2007review}.
\شروع{شکل}[H]
\centerimg{03inhomogeniety.png}{8cm}
\شرح{ناهمگنی شدت و میدان در یک تصویر ام‌آرای \مرجع{vovk2007review}}
\برچسب{شکل:اینهمو}
\پایان{شکل}

\زیرزیرقسمت{اثر حجم جزیی}
اثر حجم جزیی\LTRfootnote{Partial Volume Effect} به این دلیل بوجود می‌آید که هر واکسل یک حجم خاص از فضا را با یک مقدار شدت تعریف می‌کند حال اگر دو بافت مختلف در یک واکسل قرار گیرد، مقدار شدت این واکسل ترکیبی از جمع وزن‌دار شدت‌های این دو بافت است و بنابراین اثر حجم جزیی لبه‌های تصویر را هموارتر و محوتر می‌کند \مرجع{tohka2014partial}.

علاوه بر چالش‌های ذکر شده، چالش‌های دیگری مانند: حرکت بیمار در طی تصویربرداری، شدت‌های یکسان در بافت‌های مختلف، لبه‌های ضعیف در بافت‌های نرم و ... باعث دشوارتر شدن قطعه‌بندی تصاویر پزشکی می‌شوند.

\زیرقسمت{انواع قطعه‌بندی تصاویر پزشکی}

انواع قطعه‌بندی تصاویر پزشکی را بر اساس بعد تصویر و چالش‌های موجود در قطعه‌بندی، می‌توان به دسته‌های مختلفی تقسیم‌بندی کرد. در زیر به بررسی انواع دسته‌بندی روش‌های قطعه‌بندی پرداخته خواهد شد.

\زیرزیرقسمت{قطعه‌بندی بر اساس بعد تصویر}
همانطور که پیش‌تر اشاره گردید، تصاویر پزشکی می‌تواند دوبعدی یا سه‌بعدی باشند بنابراین روش‌های مختلفی بر اساس بعد تصاویر ارایه شده است که می‌تواند در تصاویر دو بعدی یا سه‌بعدی قطعه‌بندی را انجام دهند. همچنین برای تصاویر سه‌بعدی می‌توان الگوریتم قطعه‌بند دوبعدی را در لایه‌های مختلف تصویر اجرا کرد و نتیجه را پشت سر هم قرار داد تا قطعه‌بندی تصویر سه‌بعدی انجام شود. مزیت این روش کاهش هزینه‌های محاسباتی، پیاده‌سازی ساده‌تر و کاهش حافظه‌ی مورد نیاز است. روش‌های سه‌بعدی برای کاربردهای خاص مانند استخراج رویه و سطح ساختارهای سه‌بعدی ارایه شده‌اند که در این حالت نمی‌توان از روش‌های دوبعدی استفاده نمود \مرجع{makris2006human}.
 
\زیرزیرقسمت{قطعه‌بندی نرم و سخت}
قطعه‌بندی سخت\LTRfootnote{Hard Segmentation} برای یک پیکسل (واکسل) به صورت صفر و یک تعریف می‌شود، یا پیکسل متعلق به کلاس مورد نظر است یا نیست. تعریف ریاضیاتی قطعه‌بندی سخت را می‌توان به صورت فرمول ~\رجوع{hard_seg} ارایه داد که در آن $m_{k}(x_{i,j})$ تابع عضویت پیکسل $x_{i,j}$ در موقعیت $i,j$ تصویر به کلاس $m$ است. در این نوع قطعه‌بندی امکان حل مشکل اثر حجم جزیی وجود ندارد.
\begin{alignat}{5}
	m_{k}(x_{i,j})= \left\{ % left deliminter
	\begin{array}{l} % Array with a single, Left-justified column
		1, \quad x_{i,j} \subset S_{k}   \label{hard_seg} \\
		0, \quad \text{\lr{otherwise}}
	\end{array}
 \right. % right deliminter (required)
\end{alignat}

در دست دیگر، قطعه‌بندی نرم\LTRfootnote{Soft Segmentation} قرار دارد که امکان طبقه‌بندی پیکسل‌ها به کلاس‌های مختلف را با یک احتمال تعلق نسبت به تمام کلاس‌ها می‌دهد. فرمول‌بندی این نوع قطعه‌بندی را می‌توان در معادلات زیر ملاحظه نمود. که در آن $K$ تعداد کل کلاس‌های موجود است.

\begin{alignat}{5}
	\left\{
	\begin{array}{l}
	0 \leq m_{k}(x_{i,j}) \leq 1      \\
	\Sigma_{k = 1}^{K} m_{k}(x_{i,j}) = 1  \label{soft_seg}
	\end{array}
	\right. % right deliminter (required)
\end{alignat}

با استفاده از قطعه‌بندی نرم، می‌توان اثرات همپوشانی پیکسل‌ها و اثر حجم جزیی را حل نمود. قطعه‌بندی نرم را با یک آستانه‌گذاری می‌توان به قطعه‌بندی سخت تبدیل کرد \مرجع{sinha2020medical}.

\زیرزیرقسمت{قطعه‌بندی گسسته و پیوسته}
در قطعه‌بندی گسسته، خروجی نهایی یک نقشه‌ی گسسته، مانند تصویر اولیه است و بر اساس فاصله‌ی فضایی پیکسل‌ها (واکسل‌ها) این قطعه‌بندی صورت می‌گیرد. در سمت دیگر، قطعه‌بندی پیوسته، در یک فضای پیوسته عمل می‌کند و امکان قطعه‌بندی به صورت زیرپیکسل\LTRfootnote{Subpixel} وجود دارد. به عنوان مثال در مدل‌های شکل‌پذیر قطعه‌بندی نهایی به صورت پیوسته است \مرجع{debreuve2007using}.

\زیرزیرقسمت{قطعه‌بندی بر اساس تعامل کاربر}
انواع روش‌های قطعه‌بندی را بر اساس تعامل کاربر می‌توان به دسته‌های زیر تقسیم‌بندی نمود:
 
\شروع{فقرات}
\فقره \مهم{روش‌های دستی}: ئر این گونه روش‌ها، متخصص به صورت دستی و تعیین طبقه‌ی هر یک از پیکسل‌ها (واکسل‌ها) اقدام به قطعه‌بندی می‌کنند که یک عملیات بسیار زمان‌بر و خسته‌کننده برای متخصص و همچنین هزینه‌بر برای استخدام متخصص است.

\فقره \مهم{روش‌های نیمه‌ خودکار}: در این نوع روش‌ها، متخصص با ایجاد یک نقطه‌ی اولیه برای شروع الگوریتم، الگوریتم را راه‌اندازی می‌کند و در نهایت خروجی قطعه‌بندی ایجاد می‌شود. 

\فقره \مهم{روش‌های خودکار}: در این نوع روش‌ها عملیات قطعه‌بندی کاملا به‌ صورت خودکار انجام می‌شود و در نتیجه می‌توان تعداد بسیار زیادی تصویر را با یک دقت خاص، بدون دخالت فرد، بدست آورد. از دیگر مزیت‌های این روش‌ها نسبت به روش‌های قبل سرعت بالاتر است \مرجع{ironside2020fully}.

\پایان{فقرات}

\زیرقسمت{ارزیابی قطعه‌بندی}
برای کمی‌سازی عملکرد روش قطعه‌بندی روش‌های ارزیابی بسیار حیاتی هستند. روش‌های ارزیابی را می‌توان به دو دسته‌ی عمده تقسیم بندی کرد: 
\شروع{فقرات}
\فقره \مهم{مقایسه با قطعه‌بندی متخصص}: این روش پر استفاده‌ترین روش برای ارزیابی الگوریتم‌های قطعه‌بندی است که در آن از قطعه‌بندی شخص متخصص به عنوان استاندارد استفاده می‌شود و در نهایت با معیارهای ارزیابی بین خروجی مدل قطعه‌بند و استاندارد موجود، عملکرد قطعه‌بندی کمی‌سازی می‌گردد. از جمله مشکلات این روش می‌توان به، زمان‌بر و هزینه‌بر بودن قطعه‌بندی توسط متخصص و همچنین اختلاف نظر بین متخصصین مختلف اشاره کرد.

\فقره \مهم{استفاده از فانتوم‌های فیزیکی و ریاضیاتی}: با استفاده از فانتوم‌های\LTRfootnote{Phantom} ریاضیاتی و فیزیکی، اجزای مختلف فانتوم به طور کامل از یکدیگر تفکیک‌پذیر هستند و یک تصویرسازی دقیق از روند تصویربرداری ایجاد می‌کنند. بنابراین با قرار دادن قطعه‌بندی فانتوم به عنوان استاندارد، می‌توان الگوریتم قطعه‌بندی را ارزیابی نمود \مرجع{alfano2011mri}.

\پایان{فقرات}

با توجه به تعریف‌های فوق ملاحظه گردید که لازم است برای کمی‌سازی ارزیابی روش قطعه‌بندی  معیارهایی تعریف گردد. در ادامه به معرفی این معیارها پرداخته می‌شود.

\زیرقسمت{معیارهای ارزیابی قطعه‌بندی}
برای کمی‌سازی عملکرد قطعه‌بندی معیارهای بسیار زیادی ارایه گردیده است که از جمله مهمترین آن‌ها می‌توان به موارد زیر اشاره نمود:

\begin{multicols}{2}
	\شروع{فقرات}
	\فقره ماتریس درهم آمیختگی\LTRfootnote{Confusion Matrix}
	\فقره دقت\LTRfootnote{Accuracy}
	\فقره حساسیت\LTRfootnote{Sensitivity}
	\فقره صحت\LTRfootnote{Precision}
	\پایان{فقرات}
	
	\شروع{فقرات}
	\فقره  اختصاص\LTRfootnote{Specificity}
	\فقره معیار Dice
	\فقره معیار Jaccard
	\فقره فاصله‌ی Hausdorff
	\پایان{فقرات}
	
\end{multicols}

معیارهای پر استفاده و شناخته‌شده در قطعه‌بندی تصاویر شامل سه معیار آخر (معیار Dice، معیار Jaccard و فاصله‌ی Hausdorff ) هستند که در ادامه به بررسی بیشتر آن‌ها پرداخته می‌شود.
\زیرزیرقسمت{معیار Dice}
معیار Dice یک نشانگر آماری برای سنجش شباهت میان دو نمونه است. این معیار با نام \lr{F1-Score} نیز شناخته می‌شود. تعریف ریاضیاتی این معیار به صورت زیر است که A و B در بحث قطعه‌بندی خروجی الگوریتم و استاندارد مورد نظر هستند.
\begin{alignat}{5}
	DSC(A, B) = \frac{2 \times |A \cap B|}{|A|+|B|}    \label{dsc_def}
\end{alignat}

شکل ~\رجوع{شکل:دایس} شهود عملکرد این معیار را نشان می‌دهد. در واقع هرچقدر همپوشانی دو ناحیه بیشتر باشد این معیار به یک نزدیک‌تر می‌شود و اگر دو ناحیه به طور کامل از یکدیگر جدا باشند مقدار این معیار برابر صفر می‌گردد.

\شروع{شکل}[H]
\centerimg{03dicedef.png}{5cm}
\شرح{شهود عملکرد معیار Dice \مرجع{dicepic}}
\برچسب{شکل:دایس}
\پایان{شکل}

\زیرزیرقسمت{معیار Jaccard}
معیار Jaccard نیز مانند معیار Dice یک نشانگر آماری است که میزان مشابهت و تفاوت را میان مجموعه‌ی نمونه‌ها نشان می‌دهد.این معیار با نام اشتراک بر اجتماع\LTRfootnote{Intersection over Union} نیز شناخته می‌شود. فرمول‌بندی این معیار به صورت زیر است.
\begin{alignat}{5}
	J(A, B) = \frac{|A \cap B|}{|A \cup B|} = \frac{|A \cap B|}{|A| + |B| - |A \cap B|}   \label{jacc_def}
\end{alignat}

برای شهود بیشتر، شکل ~\رجوع{شکل:جکک} را در نظر بگیرید. هرچه میزان هم‌پوشانی دو ناحیه بیشتر شود این معیار به یک نزدیکتر می‌شود و اگر این دو ناحیه از هم جدا باشند، مقدار این معیار برابر با صفر خواهد شد.
\شروع{شکل}[H]
\centerimg{03jaccarddef.png}{8cm}
\شرح{شهود عملکرد معیار Jaccard \مرجع{jaccardpic}}
\برچسب{شکل:جکک}
\پایان{شکل}

\زیرزیرقسمت{فاصله‌ی Hausdorff}
فاصله‌ی Hausdorff در واقع معیاری است که مشخص می‌کند دو مجموعه داده چه‌ مقدار از یکدیگر دوراند. اگر نقاط متناظر در دو مجموعه داده نزدیک به یکدیگر باشند، این فاصله به صفر نزدیک می شود و هر چه این نقاط متناظر فاصله‌ی بیشتری بگیرند، مقدار این معیار بزرگتر خواهد شد. تعریف ریاضیاتی این فاصله به صورت زیر است:
\begin{alignat}{5}
	&HD(G, A) = \max (hd(G, A), hd(A, G))     \label{hd_def} && \\
	&hd(G, A) = \max_{g \in G} \min_{a \in A} ||g-a||_{2} && \notag \\
	&hd(A, G) = \max_{a \in A} \min_{g \in G} ||g-a||_{2} && \notag
\end{alignat}
که در آن، A خروجی الگوریتم قطعه‌بندی و G استاندارد مطلوب و $||.||_{2}$ نشان دهنده‌ی نرم اقلیدسی است. در فاصله Hausdorff به صورت شهودی مطابق شکل ~\رجوع{شکل:هاس} بیشینه‌ی کمینه‌ فاصله‌های لبه‌های خروجی الگوریتم با لبه‌های استاندارد مطلوب محاسبه می‌شود.
\شروع{شکل}[H]
\centerimg{03hausdorff.png}{5cm}
\شرح{شهود عملکرد فاصله‌ی Hausdorff \مرجع{hausdorffpic}}
\برچسب{شکل:هاس}
\پایان{شکل}

\قسمت{روش‌های قطعه‌بندی}
با نگاه در طول زمان، روش‌ها و تکنیک‌های پیشنهاد شده‌ی قطعه‌بندی با گذشت زمان پیشرفت چشمگیری داشته‌اند. روش‌ها و الگوریتم‌های معرفی شده در این حوزه بسیار فراوان هستند. برای بررسی این روش‌ها در این  مطالعه، بر اساس تمرکز روش‌ ارایه شده بر یک ویژگی غالب در تصویر یا یک زمینه‌ی خاص، دسته‌بندی صورت گرفته است و سپس در هر دسته این روش‌ها معرفی شده‌اند. در ادامه به بررسی روش‌های موجود در زمینه‌ی قطعه‌بندی پرداخته می‌شود.

\زیرقسمت{روش‌های آستانه‌گذاری}
آستانه‌گذاری\LTRfootnote{Thresholding} یکی از پر استفاده‌ترین روش‌های قطعه‌بندی است که بر اساس شدت پیکسل‌ها عمل می‌کند. با اعمال یک آستانه به شدت‌ پیکسل‌های تصویر می‌توان پیش‌زمینه را از پس‌زمینه تفکیک داد و یک قطعه‌بندی دو کلاس صورت داد. معادله‌ی ~\رجوع{thresh} توصیف ریاضیاتی قطعه‌بندی ($S$) یک تصویر دوبعدی $X$ را در مختصات $i, j$ با آستانه‌ی $T$ نشان می‌دهد.

\begin{alignat}{5}
	S(i, j)=
	\left\{
	\begin{array}{l}
		1 \quad X(i, j) \geq T      \\
		0 \quad X(i, j) < T  \label{thresh}
	\end{array}
	\right. % right deliminter (required)
\end{alignat}

روش آستانه‌گذاری را می‌توان با تعیین چندین آستانه، به یک قطعه‌بند چند کلاس تعمیم داد. نکته‌ی مهم در این روش، پیدا کردن آستانه بهینه است. برای این منظور روش‌های زیادی ارایه گردیده‌ است که از جمله این روش‌ها می‌توان به موارد زیر اشاره نمود:

\شروع{فقرات}
\فقره \مهم{تئوری تصمیم بیز}\LTRfootnote{Bayes Decision Theorem}: در این روش، در ابتدا با متدهای تخمین تابع توزیع (مانند مدل مخلوط گاوسی\LTRfootnote{Gaussian Mixture Models (GMM)})، توزیع شدت پیکسل‌ها استخراج می‌شود. در نهایت روش بیز با کمینه کردن مجموع مقدار  مثبت و منفی کاذب\LTRfootnote{False Positive and False Negative} مقدار آستانه‌ی بهینه را استخراج می‌کند \مرجع{huang2008new}.

\فقره \مهم{روش آستانه‌گذاری اوتسو}\LTRfootnote{Otsu’s Thresholding}: در این روش با بیشینه‌سازی یک تابع هزینه، مقدار آستانه‌ی بهینه بدست می‌آید. این تابع هزینه از دو قسمت واریانس بین کلاس‌ها و واریانس درون کلاسی تشکیل شده است که با بیشینه کردن تابع هزینه، واریانس بین کلاس‌ها بیشینه و واریانس درون کلاس‌ها کمینه می‌شود و در نهایت آستانه‌ی مطلوب بدست می‌آید \مرجع{otsu1979threshold}.
\پایان{فقرات}

\زیرقسمت{روش‌ رشد ناحیه‌ای}
رشد ناحیه‌ای یک روش قطعه‌بندی تعاملی است که یک هسته‌ی اولیه توسط کاربر برای قطعه‌بندی انتخاب می‌شود. سپس با مقایسه‌ی شدت روشنایی هسته‌ی اولیه با پیکسل‌های کناری، اگر این اختلاف کوچکتر از یک آستانه بود این ناحیه توسعه پیدا می‌کند تا در نهایت به پیکسل‌های با شدت‌های متفاوت برسد. مشکل این روش قطعه‌بندی نیمه-خودکار بودن آن است و لازم است هر بار توسط یک متخصص برای هر ناحیه، مقدار دهی اولیه صورت گیرد. همچنین قبل از قطعه‌بندی با این روش باید پیش پردازش‌هایی برای بهبود و همنواخت کردن شدت پیکسل‌های متعلق به یک بافت صورت گیرد \مرجع{adams1994seeded}.

\زیرقسمت{روش‌‌های طبقه‌بندی}
روش‌های مبتنی بر طبقه‌بندی برای قطعه‌بندی تصاویر، معمولا با استخراج نقشه‌ی ویژگی\LTRfootnote{Feature Map} از تصویر و دادن این ویژگی‌ها به یک طبقه‌بند برای تصمیم‌گیری نهایی صورت می‌گیرد. این نقشه‌ی ویژگی می‌تواند شامل ویژگی‌های سطح پایین مثل شدت روشنایی و یا پاسخ تصویر نسبت به یک فیلتر تا ویژگی‌های سطح بالاتر استخراج شده توسط الگوریتم‌های دیگر باشد\زیرنویس{مانند الگوریتم‌های SIFT ، SURF و ...}. روش‌های طبقه‌بندی معمولا از مدل‌های شناخت الگو بهره می‌برند و به نحوی می‌توان این روش‌ها را یادگیری با سرپرست نامید که نتیجه‌ی مطلوب و استاندارد مورد نظر در دسترس است\مرجع{bezdek1993review}. روش‌های طبقه‌بندی را می‌توان به تکنیک‌های زیر تقسیم‌بندی نمود.

\زیرزیرقسمت{روش‌‌ بیشینه‌کردن شباهت}
در روش‌‌ بیشینه‌کردن شباهت\LTRfootnote{Maximum Likelihood} هدف ارایه دادن یک طبقه‌بند بر اساس تابع احتمال با کمترین خطای ممکن است. در این تکنیک، نقشه‌ی ویژگی استخراج شده باید خاصیت احتمالاتی ویژگی‌ها را داشته باشد تا این الگوریتم به درستی عمل کند \مرجع{le1990maximum}.

\زیرزیرقسمت{نزدیک‌ترین همسایگی}
روش نزدیک‌ترین همسایگی\LTRfootnote{Nearest neighbor} یک روش غیر پارامتری\LTRfootnote{Non-Parametric} است که با هدف طبقه‌بندی ارایه شده است. در این روش با بررسی ویژگی یک نقطه در نقشه‌ی ویژگی و مقایسه با نقاط نزدیک در نقشه‌ی ویژگی برچسب مطلوب اعمال می‌گردد. 

\زیرزیرقسمت{شبکه‌های عصبی}
استفاده از شبکه‌های عصبی برای طبقه‌بندی یک روش پر استفاده است که در این تکنیک ابتدا ویژگی‌های مورد نظر از تصویر استخراج می‌گردد و با رویکرد یادگیری با سرپرست در صورت وجود خروجی مطلوب و یا یادگیری بدون سرپرست در صورت نبود استاندارد مورد نظر، شبکه نسبت به طبقه‌بندی یادگیری را صورت می‌دهد. توجه شود که در این نوع روش‌ها معمولا ویژگی‌ها از پیش استخراج شده‌اند و عملکرد شبکه‌ی عصبی فقط طبقه‌بندی است \مرجع{song2007modified}.

\زیرزیرقسمت{درخت تصمیم}
درخت تصمیم\LTRfootnote{Decision Tree} یک تکنیک ساده و پر استفاده برای طبقه‌بندی است. طبقه‌بند درخت تصمیم مجموعه‌ای از پرسش‌ها و ارزیابی‌ها را در یک شکل درختی ساختار می‌دهد و با بررسی ویژگی‌ها در هر شاخه در نهایت به یک تصمیم بله یا خیر می‌رسد \مرجع{bhatt2009efficient}.

\زیرقسمت{روش‌‌های خوشه‌بندی}
روش‌های خوشبه‌بندی مانند روش‌های طبقه‌بندی یک هدف را دنبال می کنند اما در این رویکرد بر عکس طبقه بندی از یادگیری بدون سرپرست استفاده می‌شود و داده‌ها بدون حضور استاندارد مطلوب، قطعه‌بندی می‌شوند. دو نوع روش خوشه‌بندی متداول در حوزه‌ی قطعه‌بندی بسیار استفاده می‌شوند که در ادامه به معرفی هر یک پرداخته می‌شود.

\زیرزیرقسمت{K-means}
در تکنیک K-means، ابتدا تعداد خوشه‌ی مدنظر توسط کاربر مشخص می‌شود و سپس به ازای هر خوشه یک مرکز خوشه به صورت تصادفی در فضای ویژگی قرار می‌گیرد. با محاسبه‌ی فاصله‌ی هر ویژگی نسبت به هر خوشه و سپس نسبت دادن نزدیکترین مرکز خوشه به آن ویژگی، مرکز خوشه‌ها به‌روز رسانی می‌شوند. این روند آنقدر تکرار می‌شود تا در نهایت مرکز خوشه‌ها ثابت شوند و دیگر تغییری نداشته باشند \مرجع{wu2007brain}. شکل ~\رجوع{شکل:کمینز} در سمت چپ یک تصویر ام‌آرآی را نشان می‌دهد که در سمت راست با روش K-means قطعه‌بندی شده است. نکته‌ی قابل توجه در این قطعه‌بندی، طبقه‌بندی به صورت سخت و قاطع است که هر پیکسل تنها متعلق به یک کلاس خاص است.

\شروع{شکل}[H]
\centerimg{03kmeans.png}{5cm}
\شرح{قطعه‌بندی تصویر ام‌آرآی مغزی با روش K-means \مرجع{ng2006medical}}
\برچسب{شکل:کمینز}
\پایان{شکل}

\زیرزیرقسمت{\lr{Fuzzy C-means}}
این تکنیک بر اساس تئوری فازی بنا شده‌است که برعکس K-means که به صورت قطعه‌بندی سخت عمل می‌کند، در اینجا شاهد یک قطعه‌بندی نرم هستیم که امکان محاسبه‌ی احتمال تعلق به هر کلاس را بوجود می‌آورد \مرجع{wiharto2020comparison}. شکل ~\رجوع{شکل:سمینز} در سمت چپ-بالا یک تصویر ام‌آرآی مغزی را نشان می‌دهد که توسط روش \lr{Fuzzy C-means} نقشه‌ی احتمال تعلق هر پیکسل به هر کلاس نشان داده شده‌است.

\شروع{شکل}[H]
\centerimg{03cmeans.jpg}{5cm}
\شرح{قطعه‌بندی تصویر ام‌آرآی مغزی با روش \lr{Fuzzy C-means} \مرجع{madhukumar2015evaluation}}
\برچسب{شکل:سمینز}
\پایان{شکل}


\زیرقسمت{مدل‌های شکل‌پذیر}
یک مدل شکل‌پذیر می‌تواند یک منحنی و یا یک رویه باشد که امکان تغییر آن در طول زمان وجود دارد. تغییرات این نوع مدل‌ها بر اساس تعریف تابع هزینه‌ی خود مدل و اطلاعات درون تصویر صورت می‌گیرد. این نیروهای داخلی و خارجی در نهایت خم شکل‌پذیر را به سمت لبه‌های تصویر و یا یک ویژگی مطلوب در تصویر سوق می‌دهند. این نوع مدل‌ها در دسته‌ی نیمه-خودکار قرار می‌گیرند و لازم است، یک خم اولیه‌ برای شروع الگوریتم بر روی تصویر تعریف کند. شکل ~\رجوع{شکل:دیممدل} تکامل یک خم اولیه طی چندین تکرار برای قطعه‌بندی را نشان می‌دهد.
\شروع{شکل}[H]
\centerimg{03dfmodels.png}{7cm}
\شرح{قطعه‌بندی با استفاده از مدل‌های شکل‌پذیر \مرجع{Fatemizadeh}}
\برچسب{شکل:دیممدل}
\پایان{شکل}
مدل‌های شکل‌پذیر را می‌توان به دو دسته‌ی عمده‌ی مدل‌های شکل‌پذیر پارامتری (صریح) \LTRfootnote{Parametric (explicit) deformable model} و مدل‌های شکل‌پذیر هندسی (ضمنی)\LTRfootnote{Geometric (implicit) deformable model} تقسیم نمود.
\زیرزیرقسمت{مدل‌های شکل‌پذیر پارامتری}
به این نوع مدل‌ها، کانتور‌های فعال یا مدل‌های snake نیز گفته می‌شود. ایده‌ی اصلی در طراحی این مدل‌ها یافتن مرزها با تطابق مدل شکل‌پذیر و منحنی‌های درون تصویر با استفاده از نیروهای داخلی و خارجی است که با بهینه‌ کردن یک تابع هزینه بدست می‌آیند. نیروهای داخلی شامل قابلیت ارتجاع\LTRfootnote{Elasticity} و سختی\LTRfootnote{Rigidity} مدل است و نیرهای خارجی باعث کشش کانتور به سمت لبه‌های تصویر می شود \مرجع{he2008comparative}.

\زیرزیرقسمت{مدل‌های شکل‌پذیر هندسی}
مدل‌های شکل‌پذیر هندسی و یا مجموعه-تراز\LTRfootnote{Level Set} از تئوری تکامل منحنی و مجموعه-تراز به‌جای پارامتری کردن منحنی استفاده می‌کنند. عملکرد این مدل‌ها بر اساس یافتن مجموعه-تراز صفر در یک رویه‌ با بعد بالاتر است که قطعه‌بندی نهایی را توصیف می‌کند \مرجع{jiang2012survey}. شکل ~\رجوع{شکل:لولست} روند تکامل منحنی و استخراج مجموعه‌-تراز صفر برای قطعه بندی یک ساختار دوبعدی را نشان می‌دهد.
\شروع{شکل}[H]
\centerimg{03levelset.png}{6cm}
\شرح{روش تکامل منحی و استخراج مجموعه-تراز صفر برای قطعه‌بندی \مرجع{levelsetpic}}
\برچسب{شکل:لولست}
\پایان{شکل}

\زیرقسمت{مدل‌های مبتنی بر اطلس}
روش‌های مبتنی بر اطلس زمانیکه یک اطلس و یا قالب استاندارد در دسترس باشد یکی از قدرتمندترین ابزارها برای قطعه‌بندی تصاویر پزشکی هستند. اطلس با گردآوری اطلاعات مربوط به آناتومی که نیاز به قطعه‌بندی دارد، تولید می شود و سپس به عنوان مرجع برای قطعه‌بندی استفاده می‌گردد.

به اینگونه روش‌ها به عنوان یک مساله‌ی انطباق تصویر نگاه می‌شود که در ابتدا یک نگاشت یک به یک که تصویر اطلس از پیش قطعه‌بندی شده را بر روی تصویر هدف منطبق می‌کند، پیدا می‌شود و سپس قطعه‌بندی اطلس با همین نگاشت تبدیل داده می‌شود تا قطعه‌بندی هدف حاصل شود. این نوع روش‌ها برای قطعه‌بندی ساختارهایی بهتر نتیجه می‌دهند که تغییر شکل ندارند مانند استخوان‌ها \مرجع{kalinic2009atlas}. شکل ~\رجوع{شکل:اطلسبیس} روند کلی قطعه‌بندی بر اساس اطلس را نشان می‌دهد.
 \شروع{شکل}[H]
 \centerimg{03atlassegmentaion.jpg}{8cm}
 \شرح{روش مبتنی بر اطلس بری قطعه‌بدی تصویر مغزی \مرجع{bourouis2020toward}}
 \برچسب{شکل:اطلسبیس}
 \پایان{شکل}

\زیرقسمت{سایر روش‌های قطعه‌بندی}
علاوه بر آنچه اشاره گردید، روش‌های دیگری نیز برای قطعه‌بندی مانند روش‌های مبتنی بر گراف، روش‌ها هیبرید (استفاده توام از چند روش قطعه‌بندی)، روش‌های مبنی بر معادلات دیفرانسیل جزئی و ... نیز ارایه شده است \مرجع{masood2015survey} که به دلیل کمتر استفاده شدن، از توضیح آن‌ها خودداری می‌شود.

\قسمت{قطعه‌بندی با استفاده از شبکه‌های عصبی عمیق}
از یک الگوریتم قطعه‌بندی تصاویر پزشکی مناسب انتظار می‌رود موارد زیر را ارضا کند \مرجع{sharma2010automated}.
\begin{multicols}{2}
	\شروع{فقرات}
	\فقره دقت بالا
	\فقره قابلیت اطمینان بالا
	\فقره قابلیت تکرار
	\پایان{فقرات}
	
	\شروع{فقرات}
	\فقره مقاوم در برابر نویز
	\فقره کمترین تعامل با کاربر
	\فقره سرعت بالا
	\پایان{فقرات}
	
\end{multicols}
تمامی الگوریتم‌های کلاسیکی که پیش‌تر بررسی شد، سعی در برآورده کردن موارد بالا داشتند که تا حد قابل قبولی پیش رفته‌اند و توانسه‌اند اعتماد پزشکان و متخصصان را به عنوان یک الگوریتم تشخیص کمکی، جلب کنند. با ظهور روش‌های یادگیری عمیق و شکست دادن انسان \مرجع{yu2017sketch} در بسیاری از کارها مانند طبقه‌بندی تصاویر طبیعی \مرجع{wang2019development}، بازی‌های فکری و ... توجه بسیاری برای استفاده از این روش‌ها در قطعه‌بندی تصاویر، جلب شد. با استفاده‌ از متدهای یادگیری عمیق در قطعه‌بندی تصاویر پزشکی، دقت و قابلیت اعتماد بالاتری نسبت به روش‌های کلاسیک بدست آمد و امروزه تقریبا در اکثر نرم‌افزارهای قطعه‌بندی، این روش‌ها جایگزین روش‌های کلاسیک شده‌اند. در ادامه به بررسی مقالات و روش‌ها ارایه شده در این حوزه پرداخته می‌شود.

در فصل دوم جزییات و ابزارهای مربوط به روش‌های یادگیری ماشین و یادگیری عمیق بررسی گردید. در این فصل استفاده‌ی این ابزارها در قطعه‌بندی تصاویر پزشکی و ایده‌هایی که باعث بهبود این روش‌ها شده‌اند بررسی می‌شوند.

\زیرقسمت{طبقه‌بندی پیکسل‌ها برای قطعه‌بندی}
با ظهور و معرفی شبکه‌های عصبی عمیق در سال 2012 برای طبقه‌بندی تصاویر طبیعی \مرجع{krizhevsky2012imagenet} و یک جهش بزرگ در دقت طبقه‌بندی، استفاده از این روش‌ها در قطعه‌بندی رونق گرفت. اولین و ساده‌ترین ایده‌ برای ارتباط حوزه‌ی طبقه‌بندی و قطعه‌بندی، همانطور که پیش‌تر اشاره شد، استفاده از شبکه‌های عمیق برای طبقه‌بندی در سطح پیکسل‌هاست. یعنی با استخراج خودکار ویژگی از نواحی اطراف پیکسل با شبکه‌های عصبی عمیق و طبقه‌بندی پیکسل مد نظر به طبقه‌ی مطلوب است.

در \مرجع{cui2016brain} برای قطعه‌بندی تصاویر ام‌آرآی از شبکه‌های کانوولوشنی عمیق استفاده شده است که شامل چند لایه‌ پشت سرهم لایه‌های کانوولوشنی و ادغام بیشینه‌گیر است که ویژگی‌ها تصویر را استخراج می‌‌کند. رویکرد این مطالعه استفاده از روش‌های طبقه‌بندی برای قطعه‌بندی است به این صورت که یک پنجره با ابعاد 32*32 بر روی تصویر لغزانده می‌شود و یک پچ\LTRfootnote{َPatch} از تصویر استخراج می‌شود، با استفاده از این پچ پیکسل وسط برچسب‌گذاری می‌شود که برای این‌کار ابتدا توسط شبکه‌ی کانوولوشنی ویژگی‌های پچ استخراج می‌شود و سپس این ویژگی‌ها به یک شبکه‌ی تمام متصل برای طبقه‌بندی هر پیکسل داده می‌شود. شکل ~\رجوع{شکل:امارپچ} چگونگی استخراج پچ‌ها از تصویر ام‌آرآی مغزی را نشان می‌دهد و سپس در شکل ~\رجوع{شکل:پچکانو} این پچ‌ها به یک شبکه‌ی کانوولوشنی برای استخراج ویژگی و در نهایت طبقه‌بندی توسط یک شبکه‌ی تمام متصل برای قطعه‌بندی ساختارهای مغزی استفاده می‌شود.

 \شروع{شکل}[H]
\centerimg{03mripatch.png}{5cm}
\شرح{لغزاندن یک پنجره روی تصویر ام‌آر‌آی مغزی و استخراج پچ \مرجع{cui2016brain}}
\برچسب{شکل:امارپچ}
\پایان{شکل}

\شروع{شکل}[H]
\centerimg{03patchnetwork.png}{12cm}
\شرح{شبکه‌ی کانوولوشنی برای طبقه‌بندی پیکسل‌ها وسطی پچ‌ها \مرجع{cui2016brain}}
\برچسب{شکل:پچکانو}
\پایان{شکل}

ابراگیموف و زینک \مرجع{ibragimov2017segmentation}، 13 ساختار در ریسک را در 50 تصویر سی‌تی اسکن سر و گردن قطعه‌بندی کرده‌اند. رویکرد آن‌ها استفاده از شبکه‌های کانوولوشنی عمیق است که شدت‌های یکسان در بافت‌های همسان را استخراج کند و بتواند در تصاویر دیده‌ نشده‌، این ساختارهای در ریسک را قطعه‌بندی کند. برای آموزش شبکه، پچ‌های مثبت که شامل شدت‌های مثبت و اطراف واکسل ساختار در ریسک هستند و همچنین پچ‌های منفی که شامل واکسل‌های ساختارهای کناری هستند استخراج می‌شود. سپس این پچ‌ها به شبکه‌ی کانوولوشنی داده می‌شوند که با ترکیب ویژگی‌های سطح پایین مانند لبه‌ها و نقاط کلیدی با ویژگی‌های سطح بالاتر، به طور موثری ساختارهای در ریسک را قطعه‌بندی نموده است. در شکل زیر معماری شبکه‌ی استفاده شده که شامل لایه‌های کانوولوشنی، ادغام بیشینه‌گیر و dropout است، نشان داده شده است. در نهایت ویژگی‌های استخراج شده به یک شبکه‌ی تمام متصل برای طبقه‌بندی داده می‌شود.

\شروع{شکل}[H]
\centerimg{03ibragimov.png}{10cm}
\شرح{معماری شبکه‌ی کانوولوشنی برای طبقه‌بندی بر اساس پچ ساختارهای در ریسک سر و گردن \مرجع{ibragimov2017segmentation}}
\برچسب{شکل:پچ2}
\پایان{شکل}

شکل ~\رجوع{شکل:پچریزالت} خروجی شبکه (رنگ قرمز) و قطعه‌بندی مطلوب (رنگ سبز) را برای ساختارهای در ریسک سر و گردن مانند چشم‌ها، فک و ... نشان می‌دهد.

\شروع{شکل}[H]
\centerimg{03ibragimovresults.png}{8cm}
\شرح{نتایج بدست آمده در قطعه‌بندی ساختارهای در رسیک سر و گردن (قرمز: خروجی شبکه، سبز: قطعه‌بندی مطلوب) \مرجع{ibragimov2017segmentation}}
\برچسب{شکل:پچریزالت}
\پایان{شکل}

روش‌های قطعه‌بندی بر اساس پچ، علی رغم استفاده‌ی زیاد در مواردی که ابعاد تصاویر برای آموزش بسیار بزرگ باشد و نیازمند حافظه‌ی زیاد باشد و نیز تعداد دادگان برای آموزش کم باشد (با این روش تعداد دادگان چندین برابر می‌شود) استفاده دارد \مرجع{sekou2019patch}. اما معایبی از جمله، از بین رفتن اطلاعات گسترده و مربوط به بافت\LTRfootnote{Texture} تصویر، ایجاد قطعه‌هایی در جاهایی که مرتبط با بافت هدف برای قطعه‌بندی نیست و همچنین تصمیم‌گیری تنها بر اساس پیکسل‌های کناری است که از استخراج ویژگی‌های سطح‌ بالاتر پیشگیری می‌شود. یکی دیگر از معایب آن به علت وجود شبکه‌ی تمام متصل، داشتن ورودی با ابعاد خاص است زیرا با تغییر ورودی ابعاد ویژگی‌ استخراج شده تغییر می‌کند و در نتیجه باید ابعاد شبکه‌ی تمام متصل تغییر کند (مانند شبکه‌های طبقه‌بند). بنابراین محققان سعی در ارائه‌ی مدل‌هایی برای حل این مشکلات داشتند که در ادامه به بررسی این تکنیک‌ها پرداخته می‌شود \مرجع{shelhamer2016fully}.

\زیرقسمت{شبکه‌های تمام کانوولوشنی برای قطعه‌بندی}
ایده‌ی اصلی برای ساخت شبکه‌های تمام کانوولوشنی، همانطور که در بالا اشاره شد، قطعه‌بندی بر اساس اطلاعات کل تصویر است. بنابراین با دادن یک تصویر به عنوان ورودی، با همان ابعاد، نقشه‌ی قطعه‌بندی خروجی ایجاد می‌شود \مرجع{long2015fully}. شکل ~\رجوع{شکل:افسیان} معماری اینگونه شبکه‌ها را نشان می‌دهد که در ابتدا ویژگی‌هایی از کل تصویر توسط لایه‌های کانوولوشنی استخراج می‌شود و سپس این ویژگی‌ها با افزایش اندازه و اعمال کانوولوشن بر روی ویژگی‌های تغییر اندازه یافته، نقشه‌ی قطعه‌بندی نهایی ایجاد می‌شود.

\شروع{شکل}[H]
\centerimg{03fcnsemanticsegmentation.png}{8cm}
\شرح{قطعه‌بندی تصاویر با استفاده از رویکرد شبکه‌های تمام کانوولوشنی \مرجع{long2015fully}}
\برچسب{شکل:افسیان}
\پایان{شکل}

لانگ و همکاران \مرجع{long2015fully} دریافتند که امکان استخراج نقشه‌ی حرارتی\LTRfootnote{Heatmap} وجود یک شی در یک تصویر، با استفاده از بخش استخراج ویژگی شبکه‌های طبقه‌بند، وجود دارد. در شکل ~\رجوع{شکل:فیچرمپ} وجود یک گربه در تصویر توسط شبکه‌های طبقه‌بند پیش‌بینی شده است و با استخراج نقشه‌ی گرمایی از ویژگی‌های استخراج شده، مکان تقریبی آن قابل دستیابی است. بنابراین با این رویکرد و استفاده از معماری شکل بالا، این گروه توانستند قطعه‌بندی را با استفاده از شبکه‌های تمام کانوولوشنی صورت دهند. 
\شروع{شکل}[H]
\centerimg{03longfeaturemap.png}{8cm}
\شرح{استخراج نقشه‌ی گرمایی وجود یک شی در تصویر با استفاده از ویژگی‌های استخراج شده توسط شبکه‌ی طبقه‌بند \مرجع{long2015fully}}
\برچسب{شکل:فیچرمپ}
\پایان{شکل}

مشکل موجود در چنین معماری‌هایی بازگرداندن ابعاد ویژگی‌های استخراج شده به اندازه‌ی تصویر اصلی است که برای آن روش‌های زیادی پیشنهاد شده است که در ادامه بررسی خواهند شد. در مقاله‌ی لانگ و همکاران برای حل این مشکل از upsample کردن ویژگی‌های استخراج شده بعد از لایه‌های ادغام و ترکیب ویژگی‌های با ابعاد مختلف با یکدیگر برای رسیدن به ابعاد تصویر اولیه است. روند این کار در شکل ~\رجوع{شکل:لانگاپسمپل} نشان داده شده است.

\شروع{شکل}[H]
\centerimg{03longupsample.png}{14cm}
\شرح{تغییر ابعاد ویژگی‌های استخراج شده بعد از لایه‌های ادغام به ابعاد تصویر اصلی \مرجع{long2015fully}}
\برچسب{شکل:لانگاپسمپل}
\پایان{شکل}

در مرجع \مرجع{noh2015learning} برای حل مشکل upsampling به جای روش‌های معمول درون‌یابی، فیلترهایی با وزن‌های قابل یادگیری ارایه دادند که باعث بهبود دقت قطعه‌بندی گردید. شبکه‌ی پیشنهادی این گروه طبق شکل ~\رجوع{شکل:دیکانونت} از دو بخش کانوولوشن و دیکانوولوشن\LTRfootnote{Deconvolution} تشکیل شده است که در بخش کانوولوشن ویژگی‌های مطلوب توسط لایه‌های کانوولوشن و ادغام استخراج می‌شود و سپس بخش دیکانوولوشن این ویژگی‌ها را به ابعاد تصویر اصلی تغییر می‌دهد تا نقشه‌ی قطعه‌بندی حاصل شود. 

\شروع{شکل}[H]
\centerimg{03nohdeconvnet.png}{14cm}
\شرح{معماری شبکه‌ی شامل کانوولوشن و دیکانوولوشن برای بهبود دقت قطعه‌بندی \مرجع{noh2015learning}}
\برچسب{شکل:دیکانونت}
\پایان{شکل}

برای تفهیم ایده‌ی لایه‌های دیکانوولوشن ارایه شده در این شبکه، شکل ~\رجوع{شکل:دیکانولایر} را در نظر بگیرید. در سمت بالا-چپ، عملکرد لایه‌ی ادغام بیشینه‌گیر نشان داده شده‌است که مقدار بزرگترین درایه و موقهیت آن‌را ذخیره می‌کند. در سمت بالا-راست، لایه‌ی برعکس لایه‌ی ادغام نشان داده شده‌است که با دانستن موقعیت بزرگترین درایه در هنگام upsampling آن‌را در موقعیت پیشین خود قرار می‌دهد. در سمت پایین-چپ، لایه‌ی کانوولوشنی نشان داده شده‌است که در فصل دوم عملکرد آن بررسی گردید و در نهایت در سمت پایین-راست، عملکرد لایه ی دیکانوولوشن توضیح داده شده‌است که یک فیلتر با وزن‌های قابل یادگیری در یک مقدار ضرب می‌شود و به ابعاد بزرگتری تغییر اندازه می‌دهد، با لغزاندن این فیلتر و جمع کردن مقادیر همپوشان با یکدیگر، ابعاد ماتریس ویژگی بزرگتر می‌شود.

\شروع{شکل}[H]
\centerimg{03deconvlayer.png}{8cm}
\شرح{نمایش تفاوت عملکرد کانوولوشن و دیکانوولوشن \مرجع{noh2015learning}}
\برچسب{شکل:دیکانولایر}
\پایان{شکل}

رونبرگر و همکاران \مرجع{ronneberger2015u} برای قطعه‌بندی تصاویر پزشکی یک معماری جدید و پر استفاده به نام UNet ارایه دادند. شکل ~\رجوع{شکل:یونتارکیتکتر} این معماری را نشان می‌دهد که از دو مسیر انقباضی و انبساطی تشکیل شده‌است. در مسیر انقباضی روند معمول در شبکه‌های کانوولوشنی پیاده‌سازی شده‌است که شامل، لایه‌های کانوولوشنی 3*3 که بعد از آن‌ها از تابع فعالیت ReLU استفاده شده است و در نهایت یک لایه‌ی ادغام بیشینه‌گیر 2*2 برای کاهش ابعاد ماتریس ویژگی به نصف ابعاد اولیه قرار داده شده‌است. در هر قدم از کاهش ابعاد تعداد کانال‌های ویژگی‌ها دو برابر شده‌است.

در مسیر انبساطی، بعد از هر بار upsampling یک کانوولوشن 2*2 قرار داه شده‌است که در تصویر با نام 'Up-convolution' نشان داده شده‌ و در طی این عملیات تعداد کانال‌های ویژگی نصف می‌شود. نکته‌ی مهم در این معماری قرار دادن مسیر‌های اتصالی از مسیر انقباضی به مسیر انبساطی است. این کار باعث حل شدن مشکل محو شدن گرادیان طی به‌روز رسانی وزن‌ها می‌شود و همچنین اطلاعات و جزییاتی که به دلیل استفاده از لایه‌های ادغام از بین می‌روند دوباره در این مسیر احیا می شود و باعث بهبود دقت قطعه‌بندی می‌گردد. در نهایت برروی کانال‌های ویژگی بدست آمده یک کانوولوشن 1*1 برای تغییر عمق کانال‌ها زده می‌شود و نقشه‌های قطعه بندی مطلوب با کمینه کردن تابع هزینه ایجاد می‌شوند.

\شروع{شکل}[H]
\centerimg{03unetarchitecture.png}{9cm}
\شرح{معماری شبکه‌ی UNet \مرجع{ronneberger2015u}}
\برچسب{شکل:یونتارکیتکتر}
\پایان{شکل}

برای بهبود عملکرد upsampling در معماری UNet همانند آنچه در شکل ~\رجوع{شکل:دیکانولایر} بالا-راست، مشاهده شد، معماری جدیدی به نام SegNet معرفی گردید \مرجع{badrinarayanan2017segnet} که مختصات بزرگترین درایه‌ها را در لایه‌های ادغام مسیر انقباضی ذخیره می‌کند و سپس برای upsample کردن، مقادیر را دقیقا در همان درایه‌های متناظر قرار می‌دهد و برعکس روش‌های دیگر، مابقی درایه‌ها برابر با صفر قرار داده می‌شوند. شکل ~\رجوع{شکل:سگنت} معماری این شبکه را نشان می‌دهد که علاوه بر مسیرهای اتصالی، درایه‌های لایه‌های ادغام نیز عبور داده می‌شود.

\شروع{شکل}[H]
\centerimg{03segnetarchitecture.png}{14cm}
\شرح{معماری شبکه‌ی SegNet \مرجع{badrinarayanan2017segnet}}
\برچسب{شکل:سگنت}
\پایان{شکل}

\زیرقسمت{شبکه‌های تمام کانوولوشنی سه‌بعدی برای قطعه‌بندی}
با گسترش استفاده‌ی شبکه‌های کانوولوشنی دوبعدی برای پردازش تصاویر دوبعدی و حاصل شدن نتایج خیره کننده، استفاده‌ی این نوع شبکه‌ها برای پردازش ویدیو نیز مورد توجه قرار گرفت. در دنباله‌های ویدیویی، علاوه بر ابعاد طول و عرض تصویر بعد زمان نیز اضافه می‌شود و یک رشته‌ی سه‌بعدی برای پردازش پدید می‌آید. بنابراین با توسعه‌ی شبکه‌های کانوولوشنی دو‌بعدی به سه‌بعدی امکان پردازش ویدیو نیز مهیا شد \مرجع{maturana2015voxnet, chen2021rgb}.

با این توسعه، پردازش تصاویر سه‌بعدی پزشکی مانند ام‌آرآی و سی‌تی اسکن، نیز مورد توجه قرار گرفت که بحث قطعه‌بندی این نوع تصاویر را نیز شامل می‌شود. بنابراین با تعمیم شبکه‌های دوبعدی به سه‌بعدی تمام کانوولوشنی، می‌توان مساله‌ی قطعه‌بندی را با تصویر سه‌بعدی انجام داد. در ادامه به بررسی شبکه‌های سه‌بعدی ارایه شده برای قطعه‌بندی تصاویر سه بعدی پرداخته خواهد شد.

شبکه‌ی UNet سه‌بعدی یا \lr{3D UNet} مشابه معماری UNet دوبعدی از مسیر‌های انقباضی (بخش رمزگذار 'Encoder' ) و انبساطی (بخش رمزگشا 'Decoder' ) تشکل‌ شده‌است با این تفاوت که تمامی محاسبات کانوولوشن و ادغام در فضای سه‌بعدی انجام می‌شود \مرجع{cciccek20163d}. معماری این شبکه در شکل زیر نشان داده شده‌است.

\شروع{شکل}[H]
\centerimg{03unet3d.png}{10cm}
\شرح{معماری شبکه‌ی UNet سه‌بعدی \مرجع{cciccek20163d}}
\برچسب{unet3dpic}
\پایان{شکل}

بلوک‌های residual توسط هی و همکاران \مرجع{he2016deep} برای آموزش موثر شبکه، ارایه شدند. ایده‌ی اصلی این بلوک‌ها ایجاد یک تطابق یک‌ به یک برای میانبر کردن لایه‌های شامل پارامتر و تجمیع ورودی و خروجی در انتهای این بلوک است. این بلوک‌ها انتشار اطلاعات را هموارتر می‌کنند و باعث آموزش بهتر شبکه می‌شوند. در شکل ~\رجوع{شکل:رزیجوال} یک بلوک دارای اتصالات residual نشان داده شده‌است.

\شروع{شکل}[H]
\centerimg{03residualconnection.png}{5cm}
\شرح{یک بلوک با اتصال residual \مرجع{li2017compactness}}
\برچسب{شکل:رزیجوال}
\پایان{شکل}

کانوولوشن‌های منبسط شده\LTRfootnote{Dilated Convolution} همانند کانوولوشن‌های عادی عمل می‌کنند با این تفاوت که بین المان‌های سازنده‌ی آن‌ها بر حسب ضریب انبساط، صفر قرار می‌گیرد. به این ترتیب بدون افزایش تعداد پارامتر‌های فیلتر، میدان دید بزرگتر و استخراج ویژگی از ناحیه‌‌ی بزرگتری صورت می‌پذیرد که باعث استخراج ویژگی‌های عمیق‌تری می‌شود. شکل ~\رجوع{شکل:دایلکانو}، میدان دید کانوولوشن‌های منبسط شده با ضریب انبساط به ترتیب از چپ به راست 1، 2 و 4 را نشان می‌دهد .

\شروع{شکل}[H]
\centerimg{03dilconv.png}{10cm}
\شرح{کانوولوشن‌های منبسط شده \مرجع{yu2015multi}}
\برچسب{شکل:دایلکانو}
\پایان{شکل}

با استفاده از دو ایده‌ی معرفی شده در بالا (بلوک‌های residual و کانوولوشن‌های منبسط شده) لی و همکاران یک شبکه‌ی سه‌بعدی برای قطعه‌بندی تصاویر ام‌آرآی مغزی ارایه کرده‌اند. این شبکه شامل 20 لایه‌ی کانوولوشنی است . در 7 لایه‌ی اول، از کانوولوشن‌های 3*3*3 استفاده شده‌‌است که وظیفه‌ی آن‌ها استخراج ویژگی‌های سطح پایین مانند لبه‌ها و گوشه‌هاست. در لایه‌های بعدی ضریب انبساط برای کانوولوشن‌های منبسط شده، 2 و 4 است. این لایه‌ها وظیفه‌ی استخراج ویژگی‌های سطح بالاتر را دارند. بلوک‌های residual به هر جفت لایه‌ی کانوولوشنی برای بهبود عملکرد اضافه گردیده است. همچنین از روش Batch-normalization برای کمک به فرآیند تعمیم پذیری استفاده شده است. شکل زیر معماری این شبکه را نشان می‌دهد.
\شروع{شکل}[H]
\centerimg{03resnetarc.png}{14cm}
\شرح{معماری شبکه‌ی سه‌بعدی شامل اتصالات residual و کانوولوشن انبساطی \مرجع{li2017compactness}}
\برچسب{شکل:رزیجوال}
\پایان{شکل}

شبکه‌ی VNet نیز مانند UNet سه‌بعدی از کانوولوشن و محاسبات سه‌بعدی استفاده می‌کند. تفاوت این دو معماری مطابق شکل ~\رجوع{شکل:وینت}، اضافه شدن بلوک‌های residual به معماری UNet است. این کار باعث جلوگیری از محو شدن گرادیان در لایه‌ها نخستین و همچنین عمیق‌تر کردن شبکه برای استخراج ویژگی‌های سطح بالا می‌شود \مرجع{milletari2016v}.

\شروع{شکل}[H]
\centerimg{03vnetarc.png}{10cm}
\شرح{معماری شبکه‌ی VNet \مرجع{milletari2016v}}
\برچسب{شکل:وینت}
\پایان{شکل}

علی‌رغم وجود مزیت‌های فراوان استفاده از شبکه‌های سه‌بعدی در استخراج ویژگی‌های فضایی بهتر، این شبکه‌ها با مشکلاتی از قبیل، هزینه‌ی محاسباتی بالا و حافظه‌ی مورد نیاز بالا برای استفاده و آموزش روبرو هستند \مرجع{lei2020medical}. 

\قسمت{قطعه‌بندی تومور و ساختارهای در ریسک با یادگیری عمیق}
 
در قسمت قبل، مدل‌ها و روش‌های پایه‌ای قطعه‌بندی با استفاده از شبکه‌های عصبی عمیق بررسی گردید. در این قسمت چند نمونه از مطالعاتی که با استفاده از مدل‌های یادگیری عمیق قطعه‌بندی تومور و ساختارهای در ریسک را انجام داده‌اند، مطالعه خواهد شد. نکته‌ی قابل توجه آن‌که، مبنا و شاکله‌ی اصلی این روش‌های یادگیری عمیق، ابزارهایی هستند که در قسمت قبل و در فصل دوم بررسی گردید و ابن مطالعات با اضافه‌کردن ایده‌ها و نوآوری‌هایی به این مدل‌های پایه، قطعه‌بندی مورد نظر را بهبود بخشیده‌اند.

به‌دلیل آن‌که اغلب دادگان پزشکی موجود، تعدا کمی دارند، آموزش شبکه‌های عمیق به دلیل کمبود داده با مشکل مواجه است. بنابراین با روش‌های مانند افزایش تعداد دادگان، این کمبود جبران می‌شود. یکی دیگر از این روش‌ها استفاده از مدل‌های از پیش آموزش دیده شده بر روی یک مجموعه‌ داده‌ی بزرگتر برای استخراج ویژگی‌های سطح بالاتر است. در مطالعه‌ی \مرجع{tran2020lung} برای قطعه‌بندی تومور ریوی از تصاویر سی‌تی اسکن، از این رویکرد استفاده شده است.

روش کار این پژوهش استفاده از یک شبکه‌ی Resnet از پیش آموزش دیده‌شده بر روی مجموعه داده‌ی ImageNet است \مرجع{he2016deep}. از این شبکه، به عنوان Encoder شبکه‌ی UNet استفاده شده است که ویژگی‌های عمیق و سطح بالا را از تصاویر دوبعدی سی‌تی اسکن (لایه‌های یک تصویر سه‌بعدی) استخراج می‌کند و سپس با مسیرهای ارتباطی به قسمت Decoder که قابلیت آموزش دارد متصل می‌کند تا تومور را در تصاویر دوبعدی شناسایی و قطعه‌بندی کند. 

ایده ی دیگر این مطالعه برای از دست نرفتن اطلاعات حجمی تصاویر سی‌تی اسکن، استفاده از یک UNet سه‌بعدی دیگر است که مستقیما تصویر سه‌بعدی را می‌گیرد و یک قطعه‌بندی تومور سه‌بعدی انجام می‌دهد. در نهایت با ترکیب خروجی این دو شبکه با استخراج کمترین مقدار‌ها از خروجی دو شبکه، قطعه‌بندی نهایی صورت می‌گیرد. شکل ~\رجوع{شکل:فیوژن} معماری این شبکه‌ها را نشان‌ می‌دهد.

\شروع{شکل}[H]
\centerimg{03fusion.png}{10cm}
\شرح{معماری روش پیشنهادی در \مرجع{tran2020lung}}
\برچسب{شکل:فیوژن}
\پایان{شکل}

لامبرت و همکاران \مرجع{lambert2020segthor} بر روی قطعه‌بندی چهار ساختار در ریسک 50 تصویر سی‌تی اسکن  قفسه‌ی سینه مطالعه کرده‌اند. روش پیشنهادی آن‌ها به دلیل کمبود دادگان استفاده از یک UNet ساده‌شده و همچنین افزایش سه برابری دادگان با اعمال تبدیلات خطی و غیرخطی بر روی تصویر است. UNet ساده شده‌ی آن‌ها بر خلاف UNet عادی یک مرحله لایه‌ی ادغام کمتر دارد و در نتیجه تعداد ویژگی‌های استخراج شده و لایه‌های کانوولوشنی کمتر از UNet معمول است. در بخش Decoder آن به‌جای استفاده از دیکانوولوشن، از روش درون‌یابی سه‌خطی استفاده شده است تا تعداد پارامتر‌های آموزش کاهش یابد.  در نهایت تعداد پارامترهای آموزشی از $7.2$ میلیون برای UNet عادی به $4.8$ میلیون برای مدل پیشنهادی کاهش یافته است. برای افزایش قدرت تعمیم‌پذیر شبکه از روش‌های Batch-normalization و Dropout بعد از لایه‌های کانوولوشنی استفاده شده است. همچنین ایده‌ی دیگر آن‌ها استفاده از تابع هزینه‌ی Dice برای بهبود دقت قطعه‌بندی است. شکل زیر معماری شبکه‌ی پیشنهادی این مطالعه را نشان می‌دهد.

\شروع{شکل}[H]
\centerimg{03simpleunet.png}{10cm}
\شرح{معماری UNet پیشنهادی در \مرجع{lambert2020segthor}}
\برچسب{شکل:لامبرت}
\پایان{شکل}

دانگ و همکاران \مرجع{dong2017automatic} برای قطعه‌بندی تومورهای تصاویر ام‌آرآی مغزی، از شبکه‌ی تمام کانوولوشنی UNet استفاده کرده‌اند. برای بهبود عملکرد شبکه‌ی UNet از تکنیک Dropout و جریمه‌ی وزن‌های شبکه استفاده شده‌است. همچنین از روش‌های افزایش دادگان مانند دوران، انتقال، بزرگنمایی، تغییر شدت روشنایی و ... برای افزایش دقت بهر‌ه‌گیری شده است. در نهایت این شبکه با استفاده از تابع هزینه‌ی Dice آموزش دیده است. شکل ~\رجوع{شکل:تومورسگدانگ} چهار نمونه تصویر را در مجموعه‌های سه‌تایی برای بررسی عملکرد شبکه‌ی پیشنهادی را نشان می‌دهد. مجموعه‌های سه‌تایی از چپ به راست عبارتند از: تصویر اصلی، قطعه‌بندی مطلوب و خروجی شبکه.

\شروع{شکل}[H]
\centerimg{03braintumorseg.png}{10cm}
\شرح{نتایج قطعه‌بندی تومور مغزی در تصاویر ام‌آرآی در مرجع \مرجع{dong2017automatic}}
\برچسب{شکل:تومورسگدانگ}
\پایان{شکل}

در این مرجع \مرجع{ren2018interleaved} یکی از ایرادات اساسی قطعه‌بندی ساختارهای در ریسک مورد مطالعه قرار گرفته است. همانطور که پیش‌تر اشاره گردید ساختارهای در ریسک اندازه و خواص مختلفی دارند و برخی از این ساختارها مانند اعصاب بینایی یا ساقه‌ی مغزی، به دلیل آن‌که بسیار کوچک‌اند و اختلاف شدت آن‌ها با بافت‌ها اطراف کم است بنابراین یافتن آن‌ها دشوار است و اکثر روش‌های ارایه شده این ساختارهای ریز را با دقت کمی مشخص می‌کنند. بنابراین رویکرد این مطالعه به این صورت است که با استفاده از یک شبکه‌ی کانولوشنی چند کاناله که هر کانال پچ‌های با ابعاد مختلف اطراف یک بافت را می‌گیرد، ساختارهای ریز را قطعه‌بندی کند. همانطور که در شکل زیر مشاهده می‌شود این شبکه با ورودی‌های با سایزهای مختلف ساختار مورد نظر را قطعه‌بندی می‌کند. ادعایی که در این مطالعه شده بود این بود که پچ‌های با سایز بزرگ اطلاعات کلی و موقعیت کلی بافت مورد نظر را به شبکه می‌دهد و هرچه پچ‌ها کوچکتر شوند این اطلاعات ریزتر و قطعه‌بندی دقیق‌تر انجام می‌شود.

\شروع{شکل}[H]
\centerimg{03multichannel.png}{10cm}
\شرح{روش پیشنهادی در \مرجع{dong2017automatic} برای استفاده از پچ‌های سه‌بعدی با اندازه‌ی مختلف}
\برچسب{شکل:تومورسگدانگ}
\پایان{شکل}

\قسمت{جمع‌بندی}
در این فصل به معرفی تعاریف، اهداف و چالش‌های قطعه‌بندی پرداخته شد و انواع دسته‌بندی روش‌های قطعه‌بندی معرفی گردید. معیارهای ارزیابی قطعه‌بندی مطالعه شد و در ادامه روش‌های قطعه‌بندی کلاسیک، قبل از ظهور یادگیری عمیق معرفی اجمالی گردید. سپس دیدیم با پیداش روش‌های یادگیری عمیق در قطعه‌بندی، اکثر روش‌های کلاسیک با این روش‌ها جایگزین شدند. قطعه‌بندی با استفاده از شبکه‌های عمیق عصبی امکان قطعه‌بندی تصاویر دو‌بعدی و سه‌بعدی، امکان قطعه‌بندی نرم و سخت، امکان ‌قطعه‌بندی تمام خودکار و یا نیمه‌خودکار را می‌دهد بنابراین نسبت به اکثر روش‌های کلاسیک ارجحیت دارد.

در نهایت، معماری و روش‌های پیشنهاد شده برای استفاده از یادگیری عمیق در قطعه‌بندی تومور و ساختارهای در ریسک بررسی گردید که با اضافه کردن خلاقیت‌هایی به معماری‌های پایه و استفاده از روش‌های تعمیم‌پذیری دقت شبکه افزایش داده می‌شد. در فصل بعد به معرفی روش‌های پیشنهادی بر مبنای شبکه‌های عصبی عمیق برای قطعه‌بندی ساختارهای در ریسک و تومور و بررسی نتایج استفاده از این روش‌ها پرداخته خواهد شد.

